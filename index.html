<!DOCTYPE html>
<html>

<head>

<title>KAALI AI</title>

<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="icon" href="kaali.png">

<style>

/* ===== BODY ===== */

html,body{
margin:0;
padding:0;
background:black;
color:white;
font-family:Arial;
height:100%;
overflow:hidden;
}

/* ===== CONTAINER ===== */

.container{
width:100%;
max-width:420px;
height:100%;
display:flex;
flex-direction:column;
}

/* ===== HEADER ===== */

.header{
text-align:center;
padding:10px;
border-bottom:1px solid #222;
}

.logo{
width:60px;
animation:glow 3s infinite;
}

.title{
color:gold;
font-size:20px;
}

/* ===== CHAT ===== */

#messages{
flex:1;
overflow-y:auto;
padding:10px;
}

/* ===== MESSAGES ===== */

.user{
background:#222;
padding:10px;
border-radius:10px;
margin:6px;
}

.kaali{
background:#000;
border-left:4px solid gold;
padding:10px;
border-radius:10px;
margin:6px;
}

/* ===== INPUT ===== */

.inputArea{
display:flex;
padding:10px;
border-top:1px solid #222;
}

input{
flex:1;
padding:10px;
border-radius:10px;
border:none;
}

button{
background:gold;
border:none;
padding:10px 14px;
border-radius:10px;
margin-left:5px;
cursor:pointer;
}

/* ===== GLOW ===== */

@keyframes glow{
0%{filter:drop-shadow(0px 0px 2px gold);}
50%{filter:drop-shadow(0px 0px 12px gold);}
100%{filter:drop-shadow(0px 0px 2px gold);}
}

</style>

</head>

<body>

<div class="container">

<div class="header">

<img src="kaali.png" class="logo">

<div class="title">KAALI AI</div>

</div>


<div id="messages"></div>


<div class="inputArea">

<input id="input" placeholder="Ask Kaali anything">

<button onclick="send()">Send</button>

<button onclick="voiceInput()">ðŸŽ¤</button>

<button onclick="speakLast()">ðŸ”Š</button>

</div>

</div>

<script>

/* ===== MEMORY ===== */

let history=[

{
role:"assistant",
content:"âœ¨ Namaste! I am KAALI, your mystical guide at DEJOIY. How may I assist you today? ðŸ”®"
}

];

document.getElementById("messages").innerHTML=

"<div class='kaali'><b>KAALI:</b> âœ¨ Namaste! I am KAALI, your mystical guide at DEJOIY. How may I assist you today? ðŸ”®</div>";

let lastReply="";


/* ===== SEND ===== */

async function send(){

let input=document.getElementById("input");

let msg=input.value.trim();

if(!msg) return;

input.value="";

let box=document.getElementById("messages");

box.innerHTML+=
"<div class='user'><b>You:</b> "+msg+"</div>";

history.push({
role:"user",
content:msg
});

box.innerHTML+=
"<div class='kaali'>Kaali is thinking ðŸ”®</div>";

let res=await fetch("/api/chat",{

method:"POST",

headers:{
"Content-Type":"application/json"
},

body:JSON.stringify({
messages:history
})

});

let data=await res.json();

box.removeChild(box.lastChild);

history.push({
role:"assistant",
content:data.reply
});

lastReply=data.reply;

box.innerHTML+=
"<div class='kaali'><b>KAALI:</b> "+data.reply+"</div>";

box.scrollTop=box.scrollHeight;

}


/* ===== ENTER ===== */

document.getElementById("input")
.addEventListener("keydown",e=>{
if(e.key==="Enter") send();
});


/* ===== VOICE INPUT ===== */

function voiceInput(){

const SpeechRecognition=
window.SpeechRecognition||
window.webkitSpeechRecognition;

const recog=new SpeechRecognition();

recog.lang="en-IN";

recog.start();

recog.onresult=e=>{

document.getElementById("input").value=
e.results[0][0].transcript;

send();

};

}


/* ===== KAALI VOICE ===== */

function speakLast(){

let speech=new SpeechSynthesisUtterance(lastReply);

speech.lang="en-IN";

speech.rate=1;

speech.pitch=1.1;

speechSynthesis.speak(speech);

}

</script>

</body>
</html>
